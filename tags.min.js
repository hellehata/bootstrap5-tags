var H={items:[],allowNew:!1,showAllSuggestions:!1,badgeStyle:"primary",allowClear:!1,clearEnd:!1,selected:[],regex:"",separator:[],max:0,clearLabel:"Clear",searchLabel:"Type a value",showDropIcon:!0,keepOpen:!1,allowSame:!1,baseClass:"",placeholder:"",addOnBlur:!1,showDisabled:!1,hideNativeValidation:!1,suggestionsThreshold:-1,maximumItems:0,autoselectFirst:!0,updateOnSelect:!1,highlightTyped:!1,highlightClass:"",fullWidth:!0,fixed:!1,fuzzy:!1,startsWith:!1,singleBadge:!1,activeClasses:["bg-primary","text-white"],labelField:"label",valueField:"value",searchFields:["label"],queryParam:"query",server:"",serverMethod:"GET",serverParams:{},serverDataKey:"data",fetchOptions:{},liveServer:!1,noCache:!0,debounceTime:300,notFoundMessage:"",onRenderItem:(o,t,e)=>t,onSelectItem:(o,t)=>{},onClearItem:(o,t)=>{},onCreateItem:(o,t)=>{},onBlur:(o,t)=>{},onFocus:(o,t)=>{},onCanAdd:(o,t,e)=>{},confirmClear:(o,t)=>Promise.resolve(),confirmAdd:(o,t)=>Promise.resolve(),onServerResponse:(o,t)=>o.json()},S="tags-",N="is-loading",R="is-active",b="is-invalid",q="is-max-reached",L="show",v="data-value",E="next",D="prev",P="form-control-focus",j="form-placeholder-shown",B="form-control-disabled",I=new WeakMap,z=0,F=window.bootstrap&&window.bootstrap.Tooltip;function J(o,t=300){let e;return(...i)=>{clearTimeout(e),e=setTimeout(()=>{o.apply(this,i)},t)}}function U(o,t=null){let e=p("span");document.body.appendChild(e),e.style.fontSize=t||"inherit",e.style.height="auto",e.style.width="auto",e.style.position="absolute",e.style.whiteSpace="no-wrap",e.innerHTML=o;let i=Math.ceil(e.clientWidth);return document.body.removeChild(e),i}function $(o){return o.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function k(o){return o?$(o.toString()).toLowerCase():""}function G(o,t){if(o.indexOf(t)>=0)return!0;let e=0;for(let i=0;i<t.length;i++){let s=t[i];if(s!=" "&&(e=o.indexOf(s,e)+1,e<=0))return!1}return!0}function O(o){o.style.display="none",x(o,{"aria-hidden":"true"})}function V(o){o.style.display="list-item",x(o,{"aria-hidden":"false"})}function x(o,t){for(let[e,i]of Object.entries(t))o.setAttribute(e,i)}function y(o,t){o.hasAttribute(t)&&o.removeAttribute(t)}function W(o){return["true","false","1","0",!0,!1].includes(o)&&!!JSON.parse(o)}function p(o){return document.createElement(o)}function X(o,t){let e=t[0];for(let i=1;i<t.length;i++)o=o.split(t[i]).join(e);return o.split(e)}var g=new Set,_={handleEvent:o=>{g.forEach(t=>{o.composedPath().includes(t.getHolder())||(t.afteronblur(o),g.delete(t))})}},w=class{constructor(t,e={}){if(!(t instanceof HTMLElement)){console.error("Invalid element",t);return}I.set(t,this),z++,this.i=t,this.D(e),this.h=!1,this.F=J(()=>{this.S(!0)},this.e.debounceTime),this.c=!0,this.k(),this.l=p("div"),this.r=p("div"),this.n=p("ul"),this.s=p("input"),this.l.appendChild(this.r),this.i.parentElement.insertBefore(this.l,this.i),this.M(),this.H(),this.N(),this.R(),this.q(),this.resetState(),this.handleEvent=i=>{this.w(i)},this.e.fixed&&(document.addEventListener("scroll",this,!0),window.addEventListener("resize",this)),["focus","blur","input","keydown","paste"].forEach(i=>{this.s.addEventListener(i,this)}),["mousemove","mouseleave"].forEach(i=>{this.n.addEventListener(i,this)}),["click","focusin"].forEach(i=>{document.addEventListener(i,_)}),this.loadData(!0)}static init(t="select[multiple]",e={},i=!1){let s=document.querySelectorAll(t);for(let n=0;n<s.length;n++){let l=w.getInstance(s[n]);l&&!i||(l&&l.dispose(),new w(s[n],e))}}static getInstance(t){if(I.has(t))return I.get(t)}dispose(){["focus","blur","input","keydown","paste"].forEach(t=>{this.s.removeEventListener(t,this)}),["mousemove","mouseleave"].forEach(t=>{this.n.removeEventListener(t,this)}),["click","focusin"].forEach(t=>{document.removeEventListener(t,_)}),this.e.fixed&&(document.removeEventListener("scroll",this,!0),window.removeEventListener("resize",this)),this.i.style.display="block",this.l.parentElement.removeChild(this.l),this.parentForm&&this.parentForm.removeEventListener("reset",this),g.has(this)&&g.delete(this),I.delete(this.i)}handleEvent(t){this.w(t)}w(t){["scroll","resize"].includes(t.type)?(this.A&&window.cancelAnimationFrame(this.A),this.A=window.requestAnimationFrame(()=>{this[`on${t.type}`](t)})):this[`on${t.type}`](t)}D(t={}){this.e=Object.assign({},H,{showDropIcon:!!this.d()});let e=this.i.dataset.config?JSON.parse(this.i.dataset.config):{},i={...t,...e,...this.i.dataset};for(let[s,n]of Object.entries(H)){if(s=="config"||i[s]===void 0)continue;let l=i[s];switch(typeof n){case"number":this.e[s]=parseInt(l);break;case"boolean":this.e[s]=W(l);break;case"string":this.e[s]=l.toString();break;case"object":this.e[s]=l,typeof l=="string"&&(["{","["].includes(l[0])?this.e[s]=JSON.parse(l):this.e[s]=l.split(l.includes("|")?"|":","));break;case"function":this.e[s]=typeof l=="string"?l.split(".").reduce((a,r)=>a[r],window):l,this.e[s]||console.error("Invalid function",l);break;default:this.e[s]=l;break}}this.e.placeholder||(this.e.placeholder=this.P()),this.e.suggestionsThreshold==-1&&(this.e.suggestionsThreshold=this.e.liveServer?1:0)}config(t=null){return t?this.e[t]:this.e}setConfig(t,e){this.e[t]=e}k(){for(this.overflowParent=null,this.parentForm=this.i.parentElement;this.parentForm&&(this.parentForm.style.overflow==="hidden"&&(this.overflowParent=this.parentForm),this.parentForm=this.parentForm.parentElement,!(this.parentForm&&this.parentForm.nodeName=="FORM")););this.parentForm&&this.parentForm.addEventListener("reset",this)}P(){if(this.i.hasAttribute("placeholder"))return this.i.getAttribute("placeholder");if(this.i.dataset.placeholder)return this.i.dataset.placeholder;let t=this.i.querySelector("option");return!t||!this.e.autoselectFirst?"":(y(t,"selected"),t.selected=!1,t.value?"":t.textContent)}N(){let t=this.i;this.e.hideNativeValidation?(t.style.position="absolute",t.style.left="-9999px"):t.style.cssText="height:1px;width:1px;opacity:0;padding:0;margin:0;border:0;float:left;flex-basis:100%;min-height:unset;",t.tabIndex=-1,t.addEventListener("focus",e=>{this.onclick(e)}),t.addEventListener("invalid",e=>{this.l.classList.add(b)})}q(){let t=this.n;t.classList.add("dropdown-menu",S+"menu"),t.id=S+"menu-"+z,t.setAttribute("role","menu");let e=t.style;e.padding="0",e.maxHeight="280px",this.e.fullWidth||(e.maxWidth="360px"),this.e.fixed&&(e.position="fixed"),e.overflowY="auto",e.overscrollBehavior="contain",e.textAlign="unset",t.addEventListener("mouseenter",i=>{this.h=!1}),this.l.appendChild(t),this.s.setAttribute("aria-controls",t.id)}M(){let t=this.l;t.classList.add("form-control","dropdown"),["form-select-lg","form-select-sm","is-invalid","is-valid"].forEach(e=>{this.i.classList.contains(e)&&t.classList.add(e)}),this.e.suggestionsThreshold==0&&this.e.showDropIcon&&t.classList.add("form-select"),this.overflowParent&&(t.style.position="inherit"),t.style.height="auto",t.addEventListener("click",this)}H(){this.r.addEventListener("click",e=>{this.isDisabled()||this.s.style.visibility!="hidden"&&this.s.focus()});let t=this.r.style;t.display="flex",t.alignItems="center",t.flexWrap="wrap"}R(){let t=this.s;t.type="text",t.autocomplete="off",t.spellcheck=!1,x(t,{"aria-autocomplete":"list","aria-haspopup":"menu","aria-expanded":"false","aria-label":this.e.searchLabel,role:"combobox"}),t.style.cssText="background-color:transparent;color:currentColor;border:0;padding:0;outline:0;max-width:100%",this.resetSearchInput(!0),this.r.appendChild(t),this.j=window.getComputedStyle(t).direction==="rtl"}onfocus(t){g.has(this)&&g.delete(this),this.l.classList.add(P),this.showOrSearch(),this.e.onFocus(t,this)}onblur(t){g.add(this)}afteronblur(t){this.o&&this.o.abort();let e=!0;if(this.e.addOnBlur&&this.s.value&&(e=this.L()),this.l.classList.remove(P),this.hideSuggestions(e),this.c){let i=this.getSelection(),s={selection:i?i.dataset.value:null,input:this.s.value};this.e.onBlur(t,this),this.i.dispatchEvent(new CustomEvent("tags.blur",{bubbles:!0,detail:s}))}}onpaste(t){let i=(t.clipboardData||window.clipboardData).getData("text/plain").replace(/\r\n|\n/g," ");if(i.length>2&&this.e.separator.length){let s=X(i,this.e.separator).filter(n=>n);s.length>1&&(t.preventDefault(),s.forEach(n=>{this.C(n)}))}}C(t){let e=t,i={};if(this.e.allowNew)i.new=1;else{let s=this.getSelection();if(!s)return;t=s.getAttribute(v),e=s.dataset.label}this.e.confirmAdd(t,this).then(()=>{this.p(e,t,i)}).catch(()=>{})}oninput(t){let e=this.s.value;if(e){let i=e.slice(-1);if(this.e.separator.length&&this.e.separator.includes(i)){this.s.value=this.s.value.slice(0,-1);let s=this.s.value;this.C(s);return}}setTimeout(()=>{this.a()}),this.showOrSearch()}onkeydown(t){let e=t.keyCode||t.key,i=t.target;switch(t.keyCode==229&&(e=i.value.charAt(i.selectionStart-1).charCodeAt(0)),e){case 13:case"Enter":t.preventDefault(),this.L();break;case 38:case"ArrowUp":t.preventDefault(),this.h=!0,this.m(D);break;case 40:case"ArrowDown":t.preventDefault(),this.h=!0,this.isDropdownVisible()?this.m(E):this.showOrSearch(!1);break;case 8:case"Backspace":let s=this.getLastItem();this.s.value.length==0&&s&&this.e.confirmClear(s,this).then(()=>{this.removeLastItem(),this.a(),this.showOrSearch()}).catch(()=>{});break;case 27:case"Escape":this.s.focus(),this.hideSuggestions();break}}onmousemove(t){this.h=!1}onmouseleave(t){this.removeSelection()}onscroll(t){this.g()}onresize(t){this.g()}onclick(t=null){!this.isSingle()&&this.isMaxReached()||this.s.focus()}onreset(t){this.reset()}loadData(t=!1){Object.keys(this.e.items).length>0?this.setData(this.e.items,!0):this.resetSuggestions(!0),this.e.server&&(this.e.liveServer||this.S(!t))}B(){let t=this.i.selectedOptions||[];for(let e=0;e<t.length;e++)t[e].value&&!t[e].hasAttribute("selected")&&t[e].setAttribute("selected","selected")}resetState(){this.isDisabled()?(this.l.setAttribute("readonly",""),this.s.setAttribute("disabled",""),this.l.classList.add(B)):(y(this.l,"readonly"),y(this.s,"disabled"),this.l.classList.remove(B))}resetSuggestions(t=!1){this.B();let e=s=>({value:s.getAttribute("value"),label:s.textContent,disabled:s.disabled,selected:s.selected,data:Object.assign({disabled:s.disabled},s.dataset)}),i=Array.from(this.i.children).filter(s=>s.hasAttribute("label")||!s.disabled||this.e.showDisabled).map(s=>s.hasAttribute("label")?{group:s.getAttribute("label"),items:Array.from(s.children).map(n=>e(n))}:e(s));this.setData(i,t)}L(){let t=this.getSelection();if(t)return t.click(),!0;if(this.e.allowNew&&this.s.value){let e=this.s.value;return this.e.confirmAdd(e,this).then(()=>{this.p(e,e,{new:1})}).catch(()=>{}),!0}return!1}S(t=!1){this.o&&this.o.abort(),this.o=new AbortController;let e=this.i.dataset.serverParams||{};typeof e=="string"&&(e=JSON.parse(e));let i=Object.assign({},this.e.serverParams,e);if(i[this.e.queryParam]=this.s.value,this.e.noCache&&(i.t=Date.now()),i.related){let a=document.getElementById(i.related);if(a){i.related=a.value;let r=a.getAttribute("name");r&&(i[r]=a.value)}}let s=new URLSearchParams(i),n=this.e.server,l=Object.assign(this.e.fetchOptions,{method:this.e.serverMethod||"GET",signal:this.o.signal});l.method==="POST"?l.body=s:n+="?"+s.toString(),this.l.classList.add(N),fetch(n,l).then(a=>this.e.onServerResponse(a,this)).then(a=>{let r=a[this.e.serverDataKey]||a;this.setData(r,!t),this.o=null,t&&this.b()}).catch(a=>{a.name==="AbortError"||this.o.signal.aborted||console.error(a)}).finally(a=>{this.l.classList.remove(N)})}p(t,e=null,i={}){if(!this.canAdd(t,i))return null;let s=this.addItem(t,e,i);return this.v(),this.e.keepOpen?this.b():this.resetSearchInput(),s}f(t){if(t.style.display==="none")return!1;let e=t.firstElementChild;return e.tagName==="A"&&!e.classList.contains("disabled")}m(t=E,e=null){let i=this.getSelection();if(i){let s=t===E?"nextSibling":"previousSibling";e=i.parentNode;do e=e[s];while(e&&!this.f(e));e?i.classList.remove(...this.u()):i&&(e=i.parentElement)}else{if(t===D)return e;if(!e)for(e=this.n.firstChild;e&&!this.f(e);)e=e.nextSibling}if(e){let s=e.offsetHeight,n=e.offsetTop,l=e.parentNode,a=l.offsetHeight,r=l.scrollHeight,h=l.offsetTop;if(s===0&&setTimeout(()=>{l.scrollTop=0}),t===D){let f=n-h>10?n-h:0;l.scrollTop=f}else n+s-(a+l.scrollTop)>0&&s>0&&(l.scrollTop=n+s-a+1,l.scrollTop+a>=r-10&&(l.scrollTop=n-h));let c=e.querySelector("a");c.classList.add(...this.u()),this.s.setAttribute("aria-activedescendant",c.id),this.e.updateOnSelect&&(this.s.value=c.dataset.label,this.a())}else this.s.setAttribute("aria-activedescendant","");return e}a(){this.l.classList.remove(j),this.s.value?this.s.size=this.s.value.length:this.getSelectedValues().length?(this.s.placeholder="",this.s.size=1):(this.s.size=this.e.placeholder.length>0?this.e.placeholder.length:1,this.s.placeholder=this.e.placeholder,this.l.classList.add(j));let t=this.s.value||this.s.placeholder,e=window.getComputedStyle(this.l).fontSize,i=U(t,e)+16;this.s.style.width=i+"px"}z(t){for(;this.n.lastChild;)this.n.removeChild(this.n.lastChild);let e=0,i=1;for(let s=0;s<t.length;s++){let n=t[s];if(n){if(n.group&&n.items){let l=p("li");l.setAttribute("role","presentation"),l.dataset.id=""+i;let a=p("span");if(l.append(a),a.classList.add("dropdown-header","text-truncate"),a.innerHTML=n.group,this.n.appendChild(l),n.items)for(let r=0;r<n.items.length;r++){let h=n.items[r];h.group_id=i,this.E(n.items[r],e),e++}i++}this.E(n,e),e++}}if(this.e.notFoundMessage){let s=p("li");s.setAttribute("role","presentation"),s.classList.add(S+"not-found"),s.innerHTML='<span class="dropdown-item"></span>',this.n.appendChild(s)}}E(t,e){if(!t[this.e.valueField])return;let i=t[this.e.valueField],s=t[this.e.labelField],n=this.e.onRenderItem(t,s,this),l=p("li");l.setAttribute("role","presentation"),t.group_id&&l.setAttribute("data-group-id",""+t.group_id);let a=p("a");l.append(a),a.id=this.n.id+"-"+e,a.classList.add("dropdown-item","text-truncate"),t.disabled&&a.classList.add("disabled"),a.setAttribute(v,i),a.dataset.label=s;let r={};this.e.searchFields.forEach(h=>{r[h]=t[h]}),a.dataset.searchData=JSON.stringify(r),a.setAttribute("href","#"),a.innerHTML=n,this.n.appendChild(l),a.addEventListener("mouseenter",h=>{this.h||(this.removeSelection(),l.querySelector("a").classList.add(...this.u()))}),a.addEventListener("mousedown",h=>{h.preventDefault()}),a.addEventListener("click",h=>{h.preventDefault(),h.stopPropagation(),this.e.confirmAdd(i,this).then(()=>{this.p(s,i,t.data),this.e.onSelectItem(t,this)}).catch(()=>{})})}initialOptions(){return this.i.querySelectorAll("option[data-init]")}I(){this.i.querySelectorAll("option").forEach(t=>{y(t,"selected")})}reset(){this.removeAll(),this.c=!1;let t=this.initialOptions();this.I();for(let e=0;e<t.length;e++){let i=t[e],s=Object.assign({},{disabled:i.hasAttribute("disabled")},i.dataset);this.addItem(i.textContent,i.value,s)}this.v(),this.c=!0}resetSearchInput(t=!1){this.s.value="",this.a(),t||(this.O()||this.hideSuggestions(),this.s===document.activeElement&&this.s.dispatchEvent(new Event("input"))),this.isMaxReached()?(this.l.classList.add(q),this.s.style.visibility="hidden"):this.s.style.visibility=="hidden"&&(this.s.style.visibility="visible"),this.isSingle()&&!t&&document.activeElement.blur()}getSelectedValues(){let t=this.i.querySelectorAll("option[selected]");return Array.from(t).map(e=>e.value)}getAvailableValues(){let t=this.i.querySelectorAll("option");return Array.from(t).map(e=>e.value)}showOrSearch(t=!0){if(t&&!this.O()){this.hideSuggestions(!1);return}this.e.liveServer?this.F():this.b()}hideSuggestions(t=!0){this.n.classList.remove(L),x(this.s,{"aria-expanded":"false"}),this.removeSelection(),t&&this.l.classList.remove(b)}toggleSuggestions(t=!0,e=!0){this.n.classList.contains(L)?this.hideSuggestions(e):this.showOrSearch(t)}O(){return this.isDisabled()||this.isMaxReached()?!1:this.s.value.length>=this.e.suggestionsThreshold}b(){if(this.s.style.visibility=="hidden")return;setTimeout(()=>{g.has(this)||g.add(this)},0);let t=k(this.s.value),e={},i=this.n.querySelectorAll("li"),s=0,n=null,l=!1,a={};for(let r=0;r<i.length;r++){let h=i[r],c=h.firstElementChild;if(c instanceof HTMLSpanElement){h.dataset.id&&(a[h.dataset.id]=!1),O(h);continue}if(c.classList.remove(...this.u()),!this.e.allowSame){let u=c.getAttribute(v);if(e[u]=e[u]||0,this.d(c.getAttribute(v),"[selected]",e[u]++)){O(h);continue}}let f=this.e.showAllSuggestions||t.length===0,d=t.length==0&&this.e.suggestionsThreshold===0;if(!f&&t.length>0){let u=JSON.parse(c.dataset.searchData);this.e.searchFields.forEach(m=>{let C=k(u[m]),T=!1;if(this.e.fuzzy)T=G(C,t);else{let M=C.indexOf(t);T=this.e.startsWith?M===0:M>=0}T&&(d=!0)})}let A=d||t.length===0;if(f||d?(s++,V(h),h.dataset.groupId&&(a[h.dataset.groupId]=!0),!n&&this.f(h)&&A&&(n=h),this.e.maximumItems>0&&s>this.e.maximumItems&&O(h)):O(h),this.e.highlightTyped){let u=c.textContent,m=k(u).indexOf(t),C=u.substring(0,m)+`<mark class="${this.e.highlightClass}">${u.substring(m,m+t.length)}</mark>`+u.substring(m+t.length,u.length);c.innerHTML=C}this.f(h)&&(l=!0)}if(!this.e.allowNew&&!(t.length===0&&!l)&&this.l.classList.add(b),this.e.allowNew&&this.e.regex&&this.isInvalid()&&this.l.classList.remove(b),Array.from(i).filter(r=>r.dataset.id).forEach(r=>{a[r.dataset.id]===!0&&V(r)}),l&&(this.l.classList.remove(b),n&&this.e.autoselectFirst&&(this.removeSelection(),this.m(E,n))),s===0)if(this.e.notFoundMessage){let r=this.n.querySelector("."+S+"not-found");r.style.display="block";let h=this.e.notFoundMessage.replace("{{tag}}",this.s.value);r.innerHTML=`<span class="dropdown-item">${h}</span>`,this.T()}else this.hideSuggestions(!1);else this.T()}T(){let t=this.n.classList.contains(L);t||(this.n.classList.add(L),x(this.s,{"aria-expanded":"true"})),this.g(t)}g(t=!1){let e=this.j,i=this.e.fixed,s=this.e.fullWidth,n=this.s.getBoundingClientRect(),l=this.l.getBoundingClientRect(),a=0,r=0;if(i?s?(a=l.x,r=l.y+l.height+2):(a=n.x,r=n.y+n.height):s?(a=0,r=l.height+2):(a=this.s.offsetLeft,r=this.s.offsetHeight+this.s.offsetTop),e&&!s&&(a-=this.n.offsetWidth-n.width),!s){let f=Math.min(window.innerWidth,document.body.offsetWidth),d=e?n.x+n.width-this.n.offsetWidth-1:f-1-(n.x+this.n.offsetWidth);d<0&&(a=e?a-d:a+d)}s&&(this.n.style.width=this.l.offsetWidth+"px"),t||(this.n.style.transform="unset"),Object.assign(this.n.style,{left:a+"px",top:r+"px"});let h=this.n.getBoundingClientRect(),c=window.innerHeight;if(h.y+h.height>c||this.n.style.transform.includes("translateY")){let f=s?l.height+4:n.height;this.n.style.transform="translateY(calc(-100.1% - "+f+"px))"}}V(){let t=5,e=window.jQuery;return e&&e.fn.tooltip&&e.fn.tooltip.Constructor&&(t=parseInt(e.fn.tooltip.Constructor.VERSION.charAt(0))),t}W(t){return!!Array.from(this.i.querySelectorAll("option")).find(s=>s.textContent==t&&s.getAttribute("selected"))}_(t){let i=Array.from(this.i.querySelectorAll("option")).filter(s=>s.textContent==t);return!(i.length>0&&!i.find(n=>!n.getAttribute("selected")))}hasItem(t){for(let e of this.e.items){let i=e.items||[e];for(let s of i)if(s[this.e.labelField]==t)return!0}return!1}getItem(t){for(let e of this.e.items){let i=e.items||[e];for(let s of i)if(s[this.e.valueField]==t)return s}return null}J(t){return new RegExp(this.e.regex.trim()).test(t)}getSelection(){return this.n.querySelector("a."+R)}removeSelection(){let t=this.getSelection();t&&t.classList.remove(...this.u())}u(){return[...this.e.activeClasses,R]}getActiveSelection(){return this.getSelection()}removeActiveSelection(){return this.removeSelection()}removeAll(){this.getSelectedValues().forEach(e=>{this.removeItem(e,!0)}),this.a()}removeLastItem(t=!1){let e=this.getLastItem();e&&this.removeItem(e,t)}getLastItem(){let t=this.r.querySelectorAll("span."+S+"badge");return t.length?t[t.length-1].getAttribute(v):void 0}enable(){this.i.setAttribute("disabled",""),this.resetState()}disable(){y(this.i,"disabled"),this.resetState()}isDisabled(){return this.i.hasAttribute("disabled")||this.i.disabled||this.i.hasAttribute("readonly")}isDropdownVisible(){return this.n.classList.contains(L)}isInvalid(){return this.l.classList.contains(b)}isSingle(){return!this.i.hasAttribute("multiple")}isMaxReached(){return this.e.max&&this.getSelectedValues().length>=this.e.max}canAdd(t,e={}){if(!t||e.new&&!this.e.allowNew||!e.new&&!this.hasItem(t)||this.isDisabled())return!1;if(!this.isSingle()&&!this.e.allowSame){if(e.new){if(this.W(t))return!1}else if(!this._(t))return!1}return this.isMaxReached()?!1:this.e.regex&&e.new&&!this.J(t)?(this.l.classList.add(b),!1):this.e.onCanAdd&&this.e.onCanAdd(t,e,this)===!1?(this.l.classList.add(b),!1):!0}getData(){return this.e.items}setData(t,e=!1){Array.isArray(t)||(t=Object.entries(t).map(([i,s])=>({value:i,label:s}))),this.e.items!=t&&(this.e.items=t),e&&(this.I(),t.forEach(i=>{let s=i[this.e.valueField],n=i[this.e.labelField];if(s&&(i.selected||this.e.selected.includes(s))){let l=this.addItem(n,s,i.data);l&&l.setAttribute("data-init","true")}})),this.z(t),this.v()}d(t=null,e="",i=0){let n="option"+(t===null?"":'[value="'+CSS.escape(t)+'"]')+e;return this.i.querySelectorAll(n)[i]||null}setItem(t,e={}){let i=null,s=this.d(t,":not([selected])");s&&(i=this.addItem(s.textContent,s.value,e));let n=this.getItem(t);if(n){let l=n[this.e.valueField],a=n[this.e.labelField];i=this.addItem(a,l,e)}return this.a(),i}addItem(t,e=null,i={}){e||(e=t),this.isSingle()&&this.getSelectedValues().length&&this.removeLastItem(!0);let s=this.d(e,":not([selected])");if(!s){s=p("option"),s.value=e,s.textContent=t;for(let[n,l]of Object.entries(i))s.dataset[n]=l;this.i.appendChild(s),this.e.onCreateItem(s,this)}return s&&(i=Object.assign({title:s.getAttribute("title")},i,s.dataset)),s.setAttribute("selected","selected"),s.selected=!0,this.U(t,e,i),this.c&&this.i.dispatchEvent(new Event("change",{bubbles:!0})),s}v(){let t=this.i.innerHTML;this.i.innerHTML="",this.i.innerHTML=t,this.a()}U(t,e=null,i={}){let s=this.V()===5,n=i.disabled&&W(i.disabled),l=this.e.allowClear&&!n,a=t,r=p("span"),h=[S+"badge"],c=this.isSingle()&&!this.e.singleBadge;if(!c){h.push("badge");let d=this.e.badgeStyle;i.badgeStyle&&(d=i.badgeStyle),i.badgeClass&&h.push(...i.badgeClass.split(" ")),this.e.baseClass?h.push(...this.e.baseClass.split(" ")):s?h=[...h,"bg-"+d,"text-truncate"]:h=[...h,"badge-"+d],r.style.maxWidth="100%"}n&&h.push("disabled","opacity-50");let f=c?0:2;if(r.style.margin=f+"px 6px "+f+"px 0px",r.style.marginBlock=f+"px",r.style.marginInline="0px 6px",r.style.display="flex",r.style.alignItems="center",r.classList.add(...h),r.setAttribute(v,e),i.title&&r.setAttribute("title",i.title),l){let d=h.includes("text-dark")||c?"btn-close":"btn-close btn-close-white",A="margin-inline: 0px 6px;",u="left";this.e.clearEnd&&(u="right"),u=="right"&&(A="margin-inline: 6px 0px;");let m=s?'<button type="button" style="font-size:0.65em;'+A+'" class="'+d+'" aria-label="'+this.e.clearLabel+'"></button>':'<button type="button" style="font-size:1em;'+A+'text-shadow:none;color:currentColor;transform:scale(1.2);float:none" class="close" aria-label="'+this.e.clearLabel+'"><span aria-hidden="true">&times;</span></button>';a=u=="left"?m+a:a+m}r.innerHTML=a,this.r.insertBefore(r,this.s),i.title&&F&&s&&F.getOrCreateInstance(r),l&&r.querySelector("button").addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.isDisabled()||this.e.confirmClear(e,this).then(()=>{this.removeItem(e),document.activeElement.blur(),this.a()}).catch(()=>{})})}getHolder(){return this.l}clear(){this.hideSuggestions(),this.reset()}updateData(t){this.setData(t,!1),this.reset()}removeItem(t,e=!1){let i=CSS.escape(t),s=this.r.querySelectorAll("span["+v+'="'+i+'"]');if(!s.length)return;let n=s.length-1,l=s[n];l&&(l.dataset.bsOriginalTitle&&F.getOrCreateInstance(l).dispose(),l.remove());let a=this.d(t,"[selected]",n);a&&(y(a,"selected"),a.selected=!1,this.c&&!e&&this.i.dispatchEvent(new Event("change",{bubbles:!0}))),this.s.style.visibility=="hidden"&&!this.isMaxReached()&&(this.s.style.visibility="visible",this.l.classList.remove(q)),e||this.e.onClearItem(t,this)}},Y=w;export{Y as default};
//# sourceMappingURL=tags.min.js.map
